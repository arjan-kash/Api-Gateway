"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var express=require("express"),login_service_1=require("../services/login.service"),logger_util_1=require("../utils/logger.util"),api_logs_1=require("../utils/api-logs"),ROUTER=express.Router({mergeParams:!0});ROUTER.use("*",function(e,o,s){"OPTIONS"==e.method||(e.rawHeaders,e.httpVersion,e.method,e.url,o.statusCode,o.statusMessage,o.getHeaders()),s()}),ROUTER.post("/api-gateway/:opt",function(e,o,s){var r=new login_service_1.LoginService,t=new api_logs_1.ApiLogs;"pbx"==e.headers.type?"login"==e.params.opt&&"extension"==e.body.user_type?(console.log("Login Info"),r.apiGatewayLogin(e,o,s)):"login"!=e.params.opt||!e.body.hasOwnProperty("user_type")||"customer"!=e.body.user_type&&"admin"!=e.body.user_type?"forgot_password"==e.params.opt?r.pbxForgotPassword(e,o,s):(o.json({status_code:400,message:"Bad Request : please provide correct URL."}),t.log(400,"Bad Request : please provide correct URL.","LoginAPI","","","")):r.apiGatewayCustomerLogin(e,o,s):"sp"==e.headers.type?"login"==e.params.opt&&"extension"==e.body.user_type?r.softphoneLogin(e,o,s):"login"!=e.params.opt||!e.body.hasOwnProperty("user_type")||"customer"!=e.body.user_type&&"admin"!=e.body.user_type?"forgot_password"==e.params.opt&&r.softphoneForgotPassword(e,o,s):r.softphoneCustomerLogin(e,o,s):"crm"==e.headers.type?"login"==e.params.opt&&"extension"==e.body.user_type?r.crmLogin(e,o,s):"login"!=e.params.opt||!e.body.hasOwnProperty("user_type")||"customer"!=e.body.user_type&&"admin"!=e.body.user_type||r.apiGatewayCustomerLogin(e,o,s):(logger_util_1.warnLog("Invalid parameters."),o.json({status_code:406,message:"Not Acceptable : please provide type in headers"}),t.log(406,"Not Acceptable : please provide type in headers.","LoginAPI","","",""))}),module.exports=ROUTER;